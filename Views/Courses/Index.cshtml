@model IEnumerable<ZuHuanJingDemo2.Models.Course>

@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>Index</h1>
<hr />
<div class="row">
    <div class="col-5">
        <a asp-action="Create" class="btn btn-primary">Create New</a>
        <input name="search" value="" placeholder="輸入: 編號、名稱、教師" />
        <button id="searchbut" class="btn btn-info">搜尋</button>
        <label class="alert-dark"><small>*清空後搜尋即全部顯示*</small></label>
    </div>
    <div class="col-4">
        <label>排序方法</label>
        <div>
            <input name="sort" id="sort-id" value="Course_Id" type="radio" checked /><label for="sort-id">編號</label>
            <input name="sort" id="sort-name" value="Course_Name" type="radio" /><label for="sort-name">名稱</label>
            <input name="sort" id="sort-account" value="Course_Teacher" type="radio" /><label for="sort-account">教師</label>
            <input name="sort" id="sort-date" value="Course_CreateDate" type="radio" /><label for="sort-date">創建日期</label>
        </div>
    </div>
    <div class="col-3">
        <label>排序方法</label>
        <div>
            <input name="sortfun" id="sort-asc" value="ASC" type="radio" checked /><label for="sort-asc">正序</label>
            <input name="sortfun" id="sort-desc" value="DESC" type="radio" /><label for="sort-desc">倒序</label>
        </div>
    </div>
</div>
<table class="table" id="coursesTable">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Course_Id)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Course_Name)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Course_Teacher)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Course_MaxCount)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Course_SumCount)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Course_StartDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Course_EndDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Course_CreateDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Course_IsActive)
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @await Html.PartialAsync("_CourseList", Model)
    </tbody>
</table>
@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            // 搜尋按鈕點擊事件
            $("#searchbut").click(function () {
                var searchQuery = $("input[name='search']").val();
                var sortField = $("input[name='sort']:checked").val();
                var sortFun = $("input[name='sortfun']:checked").val();
                var url = `/Courses/Search?query=${searchQuery}&sortField=${sortField}&sortFun=${sortFun}`;

                $.get(url, function (data) {
                    $("#coursesTable tbody").html(data);
                });
            });

            // 排序选项改变事件
            $("input[name='sort']").change(function () {
                var searchQuery = $("input[name='search']").val();
                var sortField = $("input[name='sort']:checked").val();
                var sortFun = $("input[name='sortfun']:checked").val();
                var url = `/Courses/Search?query=${searchQuery}&sortField=${sortField}&sortFun=${sortFun}`;

                $.get(url, function (data) {
                    $("#coursesTable tbody").html(data);
                });
            });

            // 排序选项改变事件
            $("input[name='sortfun']").change(function () {
                var searchQuery = $("input[name='search']").val();
                var sortField = $("input[name='sort']:checked").val();
                var sortFun = $("input[name='sortfun']:checked").val();
                var url = `/Courses/Search?query=${searchQuery}&sortField=${sortField}&sortFun=${sortFun}`;

                $.get(url, function (data) {
                    $("#coursesTable tbody").html(data);
                });
            });
        });
    </script>
}